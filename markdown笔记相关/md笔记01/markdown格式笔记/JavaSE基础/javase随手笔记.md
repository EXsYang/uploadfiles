# 1 泛型擦除

在Java中，泛型擦除（Type Erasure）是指在编译时去掉泛型类型信息的过程。这是Java泛型实现的一个重要特征。泛型主要用于编译时类型检查，而在运行时，所有的泛型类型信息都会被擦除，转换为原始类型（Raw Types）或边界类型（Bounds）。这意味着在运行时，JVM看到的代码是不包含泛型信息的。

### 泛型擦除的举例说明

假设你有以下泛型类和方法：

```
javaCopy codepublic class Box<T> {
    private T t;

    public void set(T t) {
        this.t = t;
    }

    public T get() {
        return t;
    }
}
```

在这个例子中，`Box` 是一个泛型类，其中 `T` 是一个类型参数。当你使用这个类时，你可以为 `T` 指定任何类型：

```
javaCopy codeBox<String> stringBox = new Box<>();
stringBox.set("Hello");

Box<Integer> integerBox = new Box<>();
integerBox.set(123);
```

#### 编译时

- 在编译时，Java编译器会检查类型安全性，确保你没有尝试将错误的类型放入 `Box` 中。
- 编译器也会进行类型推断，根据你放入 `Box` 的数据类型来确定 `T` 的具体类型。

#### 运行时

- 但是，当代码被编译成字节码并在JVM上运行时，泛型信息会被擦除。这意味着，不论你之前使用了什么类型参数来实例化 `Box` 类，JVM只看到 `Box` 而不是 `Box<String>` 或 `Box<Integer>`。
- 在运行时，所有的泛型类型参数都被替换为它们的原始类型（如果是无界的类型参数，则替换为 `Object`），或者是它们的边界类型（如果有界的话）。

### 泛型擦除的目的

泛型擦除的主要目的是为了向后兼容。当Java引入泛型时，已经有大量不使用泛型的代码存在。通过泛型擦除，Java允许新代码使用泛型而不破坏旧代码的兼容性。这使得旧的Java代码和库可以在新版本的Java环境中运行，而不需要任何修改。

### 结论

泛型擦除意味着泛型仅在编译阶段有效，主要用于类型检查和类型推断。它使得编写更加类型安全的代码成为可能，同时保持了与旧Java代码的兼容性。但是，它也带来了一些限制，比如在运行时无法获取泛型的具体类型信息。

---

# 2 