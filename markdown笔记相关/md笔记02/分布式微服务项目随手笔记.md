# 1 登录到Linux的指令

~~~
#进入目录 D:\Java_developer_tools\DistributedMicroservicesProject\vbcentos7
#在该目录下进入到cmd命令台输入vagrant up 开启Linux虚拟机系统
#启动Linux虚拟机
vagrant up
#关闭Linux虚拟机
vagrant halt

#进入目录 D:\Java_developer_tools\DistributedMicroservicesProject\vbcentos7
#在该目录下进入到cmd命令台输入vagrant ssh 登录到Linux系统
#使用ssh连接到Linux虚拟机	默认用户名是vagrant
vagrant ssh

#退出ssh连接
exit

D:\Java_developer_tools\DistributedMicroservicesProject\vbcentos7>vagrant init centos/7
==> vagrant: A new version of Vagrant is available: 2.4.1 (installed version: 2.2.18)!
==> vagrant: To upgrade visit: https://www.vagrantup.com/downloads.html

A `Vagrantfile` has been placed in this directory. You are now
ready to `vagrant up` your first virtual environment! Please read
the comments in the Vagrantfile as well as documentation on
`vagrantup.com` for more information on using Vagrant.

D:\Java_developer_tools\DistributedMicroservicesProject\vbcentos7>vagrant up
Bringing machine 'default' up with 'virtualbox' provider...
==> default: Box 'centos/7' could not be found. Attempting to find and install...
    default: Box Provider: virtualbox
    default: Box Version: >= 0
==> default: Loading metadata for box 'centos/7'
    default: URL: https://vagrantcloud.com/centos/7
==> default: Adding box 'centos/7' (v2004.01) for provider: virtualbox
    default: Downloading: https://vagrantcloud.com/centos/boxes/7/versions/2004.01/providers/virtualbox/unknown/vagrant.
box
Download redirected to host: cloud.centos.org
    default:
    default: Calculating and comparing box checksum...
==> default: Successfully added box 'centos/7' (v2004.01) for 'virtualbox'!
==> default: Importing base box 'centos/7'...
==> default: Matching MAC address for NAT networking...
==> default: Checking if box 'centos/7' version '2004.01' is up to date...
==> default: Setting the name of the VM: vbcentos7_default_1707581882874_11921
==> default: Clearing any previously set network interfaces...
==> default: Preparing network interfaces based on configuration...
    default: Adapter 1: nat
==> default: Forwarding ports...
    default: 22 (guest) => 2222 (host) (adapter 1)
==> default: Booting VM...
==> default: Waiting for machine to boot. This may take a few minutes...
    default: SSH address: 127.0.0.1:2222
    default: SSH username: vagrant
    default: SSH auth method: private key
    default:
    default: Vagrant insecure key detected. Vagrant will automatically replace
    default: this with a newly generated keypair for better security.
    default:
    default: Inserting generated public key within guest...
    default: Removing insecure key from the guest if it's present...
    default: Key inserted! Disconnecting and reconnecting using new SSH key...
==> default: Machine booted and ready!
==> default: Checking for guest additions in VM...
    default: No guest additions were detected on the base box for this VM! Guest
    default: additions are required for forwarded ports, shared folders, host only
    default: networking, and more. If SSH fails on this machine, please install
    default: the guest additions and repackage the box to continue.
    default:
    default: This is not an error message; everything may continue to work properly,
    default: in which case you may ignore this message.
==> default: Rsyncing folder: /cygdrive/d/Java_developer_tools/DistributedMicroservicesProject/vbcentos7/ => /vagrant

D:\Java_developer_tools\DistributedMicroservicesProject\vbcentos7>vagrant ssh
[vagrant@localhost ~]$ pwd
/home/vagrant
[vagrant@localhost ~]$ ls
[vagrant@localhost ~]$ cd /
[vagrant@localhost /]$ ls
bin   dev  home  lib64  mnt  proc  run   srv       sys  usr      var
boot  etc  lib   media  opt  root  sbin  swapfile  tmp  vagrant
[vagrant@localhost /]$ cat /etc/centos-release
CentOS Linux release 7.8.2003 (Core)
[vagrant@localhost /]$ exit
logout
Connection to 127.0.0.1 closed.

D:\Java_developer_tools\DistributedMicroservicesProject\vbcentos7>

~~~

## 查看当前版本CentOS Linux 版本 `cat /etc/centos-release`

![image-20240212061454919](https://raw.githubusercontent.com/EXsYang/PicGo-images-hosting/main/images/image-20240212061454919.png)

要关闭使用 Vagrant 启动的 CentOS 7 虚拟机，您可以使用 `vagrant halt` 命令。这个命令会优雅地关闭虚拟机，确保所有的进程都正确地停止，并且虚拟机状态被安全地保存。

在您的项目目录（在这个例子中是 `D:\Java_developer_tools\DistributedMicroservicesProject\vbcentos7`）下打开命令行界面，然后运行以下命令：

```
vagrant halt
```

如果您想要暂时挂起虚拟机（保存其当前状态以便可以快速恢复），可以使用 `vagrant suspend`。要重新启动被挂起或停止的虚拟机，可以使用 `vagrant up`。 若要彻底删除虚拟机（包括其所有的文件和状态），可以使用 `vagrant destroy`。请注意，`vagrant destroy` 命令会移除虚拟机，如果你再次需要它，将必须重新创建和配置。



# 2 禁用Hyper-V

禁用Hyper-V可以通过几种不同的方法完成，具体取决于您使用的Windows版本。下面是一些常用的方法：

### 通过Windows功能禁用

1. 在搜索栏输入“Windows功能”，然后选择“打开或关闭Windows功能”。
2. 在弹出的窗口中，找到“Hyper-V”，取消选中旁边的复选框。
3. 点击“确定”按钮，然后根据提示重启计算机。

### 通过命令提示符禁用

1. 以管理员身份打开命令提示符。可以在搜索栏输入“cmd”，然后右键“命令提示符”，选择“以管理员身份运行”。
2. 在命令提示符窗口中，输入以下命令来禁用Hyper-V：
   ```
   dism.exe /Online /Disable-Feature:Microsoft-Hyper-V
   ```
3. 按照提示重启计算机以完成更改。

### 通过PowerShell禁用

1. 以管理员身份打开PowerShell。可以在搜索栏输入“PowerShell”，然后右键“Windows PowerShell”，选择“以管理员身份运行”。
2. 在PowerShell窗口中，输入以下命令来禁用Hyper-V：
   ```
   Disable-WindowsOptionalFeature -Online -FeatureName Microsoft-Hyper-V-All
   ```
3. 按照提示重启计算机以完成更改。

### 注意事项

- 禁用Hyper-V后，任何依赖于Hyper-V的功能或服务（如Windows沙盒、Windows子系统 for Linux 2 (WSL2)）可能无法正常工作。
- 如果您的计算机上安装了其他虚拟化软件（如VirtualBox或VMware），禁用Hyper-V可能有助于解决兼容性问题。
- 在某些情况下，特别是在Windows 10或Windows 11上，您可能还需要禁用与虚拟化相关的其他功能，如虚拟机平台和Windows Hypervisor Platform。

在完成这些步骤之后，Hyper-V应该被禁用，您可以尝试重新使用VirtualBox或其他虚拟化软件。如果您决定在将来重新启用Hyper-V，只需按照上述步骤操作，但选择启用Hyper-V功能即可。

# 3 禁用Hyper-V会影响其他虚拟软件的启动吗？比如VMware

禁用Hyper-V对其他虚拟化软件（如VMware Workstation或Oracle VM VirtualBox）的影响取决于具体的虚拟化技术和软件版本。以下是一些可能的影响和考虑因素：

### VMware Workstation

- **正面影响**：禁用Hyper-V通常对VMware Workstation是有益的，尤其是在早期版本中。因为Hyper-V是一种类型1虚拟化技术，而VMware Workstation是类型2，两者同时运行可能会引起冲突。禁用Hyper-V可以提高VMware的性能和兼容性。
- **启用VT-x/EPT或AMD-V/RVI**：禁用Hyper-V后，确保在BIOS/UEFI设置中启用了VT-x（对于Intel处理器）或AMD-V（对于AMD处理器）及其扩展（如EPT或RVI），这对于VMware正常工作是必要的。

### Oracle VM VirtualBox

- **正面影响**：对于VirtualBox，禁用Hyper-V也往往有好处。尽管VirtualBox从5.0版本开始提供了对Hyper-V作为后备执行引擎的支持，但这可能会降低性能。完全禁用Hyper-V可以让VirtualBox直接利用硬件虚拟化，从而提高性能。
- **版本兼容性**：确保您使用的VirtualBox版本最优化地支持您的操作系统，尤其是在没有Hyper-V的情况下。

### 其他虚拟化软件

- 对于其他虚拟化软件，如QEMU、KVM（在Linux上）等，禁用Hyper-V不会直接影响它们的运行。这些软件通常使用不同的虚拟化技术，与Hyper-V的兼容性问题较少。

### 注意事项

- **操作系统功能**：禁用Hyper-V可能会影响依赖于Hyper-V的Windows功能，如Windows沙箱和Windows子系统 for Linux（WSL 2）。这些功能需要Hyper-V来运行。
- **性能考虑**：在某些情况下，如果您的工作或开发环境不依赖于Hyper-V特定的功能，禁用Hyper-V可能会带来性能上的提升。
- **软件版本**：在禁用Hyper-V之前，请检查您所使用的虚拟化软件的文档，以确认其对Hyper-V的支持情况以及不使用Hyper-V时的推荐配置。

总的来说，禁用Hyper-V通常对使用VMware Workstation或VirtualBox等其他虚拟化软件有积极影响，特别是在解决兼容性问题和提高性能方面。然而，做出改变之前，请考虑任何依赖于Hyper-V的功能或服务。



# 4 宿主机和Linux网络互通

windows宿主机在VirtualBox虚拟网络里的IP地址如下:192.168.56.1 

使用命令行命令`ipconfig /all`

![image-20240211223037813](https://raw.githubusercontent.com/EXsYang/PicGo-images-hosting/main/images/image-20240211223037813.png)



![image-20240211223223891](https://raw.githubusercontent.com/EXsYang/PicGo-images-hosting/main/images/image-20240211223223891.png)

~~~
#windows真实的上网ip
192.168.0.13

#windows宿主机在VirtualBox虚拟网络里的IP 
192.168.0.13

#vagrant配置的CentOS7.8 Linux 的ip
192.168.56.100

#重新加载vagrant配置文件
vagrant reload

#登录到Linux
vagrant ssh

#查看当前ip(注意ifconfig此时用不了，需要安装netTools)
ip addr


~~~



查看修改后的Linux虚拟机IP：

![image-20240211223707217](https://raw.githubusercontent.com/EXsYang/PicGo-images-hosting/main/images/image-20240211223707217.png)



宿主机ping Linux虚拟机test1:

~~~
C:\Users\yangd>ping 192.168.56.100

正在 Ping 192.168.56.100 具有 32 字节的数据:
来自 192.168.56.100 的回复: 字节=32 时间<1ms TTL=255
来自 192.168.56.100 的回复: 字节=32 时间<1ms TTL=64
来自 192.168.56.100 的回复: 字节=32 时间<1ms TTL=64
来自 192.168.56.100 的回复: 字节=32 时间<1ms TTL=64

192.168.56.100 的 Ping 统计信息:
    数据包: 已发送 = 4，已接收 = 4，丢失 = 0 (0% 丢失)，
往返行程的估计时间(以毫秒为单位):
    最短 = 0ms，最长 = 0ms，平均 = 0ms

C:\Users\yangd>
~~~



Linux虚拟机ping windows宿主机在VirtualBox虚拟网络里的IP：192.168.56.1 test2:  

![image-20240211223037813](https://raw.githubusercontent.com/EXsYang/PicGo-images-hosting/main/images/image-20240211223037813.png)

~~~
 [vagrant@localhost ~]$ ping 192.168.56.1
PING 192.168.56.1 (192.168.56.1) 56(84) bytes of data.
64 bytes from 192.168.56.1: icmp_seq=1 ttl=128 time=0.232 ms
64 bytes from 192.168.56.1: icmp_seq=2 ttl=128 time=0.208 ms
64 bytes from 192.168.56.1: icmp_seq=3 ttl=128 time=0.221 ms
64 bytes from 192.168.56.1: icmp_seq=4 ttl=128 time=0.207 ms
^C
--- 192.168.56.1 ping statistics ---
4 packets transmitted, 4 received, 0% packet loss, time 3016ms
rtt min/avg/max/mdev = 0.207/0.217/0.232/0.010 ms
[vagrant@localhost ~]$

~~~





Linux虚拟机ping 宿主机 实际上网地址 test3: **测试虚拟机能否访问外部网络**

![image-20240211224611095](https://raw.githubusercontent.com/EXsYang/PicGo-images-hosting/main/images/image-20240211224611095.png)

~~~
 [vagrant@localhost ~]$ ping 192.168.0.13
PING 192.168.0.13 (192.168.0.13) 56(84) bytes of data.
64 bytes from 192.168.0.13: icmp_seq=1 ttl=127 time=0.444 ms
64 bytes from 192.168.0.13: icmp_seq=2 ttl=127 time=0.426 ms
64 bytes from 192.168.0.13: icmp_seq=3 ttl=127 time=0.474 ms
64 bytes from 192.168.0.13: icmp_seq=4 ttl=127 time=0.423 ms
^C
--- 192.168.0.13 ping statistics ---
4 packets transmitted, 4 received, 0% packet loss, time 3026ms
rtt min/avg/max/mdev = 0.423/0.441/0.474/0.032 ms
[vagrant@localhost ~]$
--------------------------------------------------------
[vagrant@localhost ~]$ ping www.baidu.com
PING www.baidu.com (198.18.0.78) 56(84) bytes of data.
64 bytes from 198.18.0.78 (198.18.0.78): icmp_seq=1 ttl=63 time=0.451 ms
64 bytes from 198.18.0.78 (198.18.0.78): icmp_seq=2 ttl=63 time=0.489 ms
64 bytes from 198.18.0.78 (198.18.0.78): icmp_seq=3 ttl=63 time=0.495 ms
64 bytes from 198.18.0.78 (198.18.0.78): icmp_seq=4 ttl=63 time=0.482 ms
^C
--- www.baidu.com ping statistics ---
4 packets transmitted, 4 received, 0% packet loss, time 3003ms
rtt min/avg/max/mdev = 0.451/0.479/0.495/0.022 ms
[vagrant@localhost ~]$



~~~



# 5 如何使用yum安装netTools,使得Linux可以使用ifconfig命令呢？

要在基于Red Hat的Linux发行版（如RHEL, CentOS, Fedora等）上安装`net-tools`包（这个包包含了`ifconfig`命令），你可以使用`yum`（在较旧的版本中）或`dnf`（在较新的版本中，如Fedora和RHEL 8及以上版本）包管理器。以下是使用`yum`安装`net-tools`的步骤：

1. 打开终端。

2. 输入以下命令来安装`net-tools`：

   ```
   sudo yum install net-tools
   ```

   - 这条命令会提示你输入管理员密码，输入后按回车继续。
   - 系统可能会询问你是否确认下载和安装，输入`y`然后按回车确认。

安装完成后，你就可以使用`ifconfig`命令来查看网络接口的配置了。只需在终端中输入：

```
ifconfig
```

如果你的系统使用的是`dnf`包管理器（如在Fedora或RHEL 8及以上版本），安装命令略有不同：

```
sudo dnf install net-tools
```

以上步骤适用于大多数基于Red Hat的Linux发行版。如果你使用的是基于Debian的发行版（如Ubuntu），则需要使用`apt`包管理器来安装`net-tools`：

```
sudo apt-get update
sudo apt-get install net-tools
```

这些命令将确保你的系统能够使用`ifconfig`命令来管理和查看网络接口。



# 6 vagrant ssh登录后要切换成root用户，密码默认就是vagrant

![image-20240212051538894](https://raw.githubusercontent.com/EXsYang/PicGo-images-hosting/main/images/image-20240212051538894.png)



# 7 启动docker



![image-20240212053539810](https://raw.githubusercontent.com/EXsYang/PicGo-images-hosting/main/images/image-20240212053539810.png)

~~~sh
#安装docker
https://docs.docker.com/engine/install/centos/
#安装命令执行$号后面的
$ sudo yum remove docker \
                  docker-client \
                  docker-client-latest \
                  docker-common \
                  docker-latest \
                  docker-latest-logrotate \
                  docker-logrotate \
                  docker-engine
                  

$ sudo yum install -y yum-utils
$ sudo yum-config-manager --add-repo https://download.docker.com/linux/centos/docker- ce.repo

$ sudo yum install docker-ce docker-ce-cli containerd.io 
安装完成
----------------------------------------------------
#启动docker
[vagrant@localhost ~]$ sudo systemctl start docker
#查看当前版本
[vagrant@localhost ~]$ docker -v
Docker version 25.0.3, build 4debf41
#查看当前安装的有哪些镜像
[vagrant@localhost ~]$ sudo docker images
REPOSITORY   TAG       IMAGE ID   CREATED   SIZE

#设置docker自启动
[vagrant@localhost ~]$ sudo systemctl enable docker
Created symlink from /etc/systemd/system/multi-user.target.wants/docker.service to /usr/lib/systemd/system/docker.service.
[vagrant@localhost ~]$
~~~



**执行命令前面要加`sudo` ，否则执行失败，因为这里需要管理员权限**

![image-20240212064652234](https://raw.githubusercontent.com/EXsYang/PicGo-images-hosting/main/images/image-20240212064652234.png)



## 配置阿里云容器 镜像加速，作用是让我们用docker拉取国外docker镜像速度变快

![image-20240212060119324](C:/Users/yangd/AppData/Roaming/Typora/typora-user-images/image-20240212060119324.png)



https://cr.console.aliyun.com/cn-hangzhou/instances/mirrors

![image-20240212060220055](https://raw.githubusercontent.com/EXsYang/PicGo-images-hosting/main/images/image-20240212060220055.png)





**我这里没有配置！！**



# 8 如何修改容器内部默认的3306端口呢？对于MySQL，这通常是3306。我想让它改变，如何做

要修改MySQL容器内部使用的默认端口（通常是3306）到另一个端口，你需要调整MySQL的配置文件。在Docker容器中，这通常意味着你需要采取以下步骤：

### 1. 创建自定义的MySQL配置文件

首先，创建一个自定义的MySQL配置文件，比如`my.cnf`（或者任何你想命名的文件），在该文件中指定新的端口配置。例如，如果你想将MySQL的端口改为3307，你的配置文件内容可能如下：

```ini
[mysqld]
port=3307
```

### 2. 使用Dockerfile创建自定义MySQL镜像

接下来，创建一个Dockerfile来构建一个包含你自定义配置的MySQL镜像。你的Dockerfile可能看起来像这样：

```Dockerfile
FROM mysql:latest
COPY my.cnf /etc/mysql/my.cnf
```

这个Dockerfile基于官方的MySQL镜像，将你的自定义配置文件复制到容器内适当的位置（`/etc/mysql/my.cnf`是MySQL的标准配置文件路径之一）。

### 3. 构建自定义MySQL镜像

在包含Dockerfile和`my.cnf`文件的目录下运行以下命令来构建你的自定义镜像：

```bash
docker build -t my-custom-mysql .
```

### 4. 运行你的自定义MySQL容器

最后，使用你的自定义镜像启动MySQL容器，并映射到新的端口。如果你将MySQL内部端口更改为3307，你也可能希望将容器的3307端口映射到宿主机的某个端口（这里以3307为例）：

```bash
docker run -p 3307:3307 --name my-mysql -e MYSQL_ROOT_PASSWORD=my-secret-pw my-custom-mysql
```

### 注意

- 确保在`my.cnf`配置文件中指定的端口与`docker run`命令中的端口映射相匹配。
- 修改容器内部服务的端口可能需要你调整任何依赖于这个服务的应用配置，以确保它们连接到正确的端口。
- 如果你还需要修改其他MySQL配置，可以在`my.cnf`文件中添加这些配置项。

通过这种方式，你可以控制容器内部MySQL实例使用的端口，以及如何将其映射到宿主机上。

# 9 这里你提出的自定义端口的mysql镜像方式，是需要根据官方镜像重新复制一份新的镜像对吗？

是的，按照我之前描述的步骤，你会基于官方的MySQL镜像创建一个新的自定义镜像。这个过程涉及到创建一个包含你自定义配置（如端口号变更）的配置文件，然后通过编写一个Dockerfile来指定在构建自定义镜像时将这个配置文件复制到镜像内的正确位置。这样做的目的是为了让MySQL在容器启动时使用这个自定义配置，从而监听在一个非默认端口上。

这个过程实质上是创建了一个新的镜像，它在官方MySQL镜像的基础上添加了你的自定义配置。虽然这个新镜像包含了官方镜像的所有内容，但它会根据你提供的配置文件在启动时使用不同的设置（如不同的端口号）。

这种方法的好处是提供了灵活性和控制力，允许你根据需要调整MySQL的配置，而不仅仅是端口号。例如，你可以调整缓存大小、字符集或任何其他MySQL支持的配置选项。此外，通过创建自定义镜像，你可以确保你的配置更改会被版本控制和重用，这对于维护多个环境或需要在团队中共享配置的情况特别有用。

要注意的是，每当官方MySQL镜像更新时，你可能需要重新构建你的自定义镜像以获取最新的安全修复和功能更新。这是管理自定义Docker镜像时的一个常见考虑因素。

# 10 拉取mysql镜像并启动



~~~shell
#需要执行的命令
sudo docker pull mysql:5.7

sudo docker images

#下面这个老韩给的代码不好使
sudo docker run -p 3306:3306 --name mysql \
-v /mydata/mysql/log:/var/log/mysql \
-v /mydata/mysql/data:/var/lib/mysql \
-v /mydata/mysql/conf:/etc/mysql \
-e MYSQL_ROOT_PASSWORD=root \
-d mysql:5.7

#下面这个好使
sudo docker run -p 3306:3306 --name mysql -v /mydata/mysql/log:/var/log/mysql -v /mydata/mysql/data:
/var/lib/mysql -v /mydata/mysql/conf:/etc/mysql/conf.d -e MYSQL_ROOT_PASSWORD=root -d mysql:5.7


#下面这个好使，是上面这个调整格式后的代码，区别就是加了一层目录`/conf.d`,目录没有会自动创建
sudo docker run -p 3306:3306 --name mysql \
-v /mydata/mysql/log:/var/log/mysql \
-v /mydata/mysql/data:/var/lib/mysql \
-v /mydata/mysql/conf:/etc/mysql/conf.d \
-e MYSQL_ROOT_PASSWORD=root \
-d mysql:5.7

#查看mysql容器是否启动成功，即看STATUS是否显示为UP
sudo docker ps
#启动mysql容器 下面这里的mysql 注意代表的是容器的名称！！
sudo docker start mysql

#重启mysql容器
sudo docker restart mysql

#停止mysql容器
sudo docker stop mysql

# 进入到mysql镜像(独立的Linux环境)的命令
sudo docker exec -it mysql /bin/bash

# 从Docker守护进程中删除一个名为 `mysql` 的容器。
sudo docker rm mysql 
------------------------------------------------
#过程演示
[vagrant@localhost ~]$ sudo docker pull mysql:5.7
5.7: Pulling from library/mysql
20e4dcae4c69: Pull complete
1c56c3d4ce74: Pull complete
e9f03a1c24ce: Pull complete
68c3898c2015: Pull complete
6b95a940e7b6: Pull complete
90986bb8de6e: Pull complete
ae71319cb779: Pull complete
ffc89e9dfd88: Pull complete
43d05e938198: Pull complete
064b2d298fba: Pull complete
df9a4d85569b: Pull complete
Digest: sha256:4bc6bc963e6d8443453676cae56536f4b8156d78bae03c0145cbe47c2aad73bb
Status: Downloaded newer image for mysql:5.7
docker.io/library/mysql:5.7
[vagrant@localhost ~]$ docker images
permission denied while trying to connect to the Docker daemon socket at unix:///var/run/docker.sock: Get "http://%2Fvar%2Fru
n%2Fdocker.sock/v1.24/images/json": dial unix /var/run/docker.sock: connect: permission denied
[vagrant@localhost ~]$ sudo docker images
REPOSITORY   TAG       IMAGE ID       CREATED        SIZE
mysql        5.7       5107333e08a8   2 months ago   501MB
[vagrant@localhost ~]$ docker images
permission denied while trying to connect to the Docker daemon socket at unix:///var/run/docker.sock: Get "http://%2Fvar%2Fru
n%2Fdocker.sock/v1.24/images/json": dial unix /var/run/docker.sock: connect: permission denied
[vagrant@localhost ~]$ sudo docker images
REPOSITORY   TAG       IMAGE ID       CREATED        SIZE
mysql        5.7       5107333e08a8   2 months ago   501MB

#下面老韩给的代码不好使
[vagrant@localhost ~]$ sudo docker run -p 3306:3306 --name mysql \
> -v /mydata/mysql/log:/var/log/mysql \
> -v /mydata/mysql/data:/var/lib/mysql \
> -v /mydata/mysql/conf:/etc/mysql \
> -e MYSQL_ROOT_PASSWORD=root \
> -d mysql:5.7
6bf06073853939b6fc870258547e61a40a6d6ec02975df3f76cfc0bf98fbb1e6
[vagrant@localhost ~]$
[vagrant@localhost ~]$ sudo docker ps
CONTAINER ID   IMAGE     COMMAND   CREATED   STATUS    PORTS     NAMES

#使用下面的代码好使，猜测mysql5.7 更新后目录结构改变了
[vagrant@localhost etc]$ sudo docker run -p 3306:3306 --name mysql -v /mydata/mysql/log:/var/log/mysql -v /mydata/mysql/data:
/var/lib/mysql -v /mydata/mysql/conf:/etc/mysql/conf.d -e MYSQL_ROOT_PASSWORD=root -d mysql:5.7
ab0cd95f6c9f883f34c2c0fb93f80e27e9bb1ce8e81e44bf235e7d43fb3b5bb4
[vagrant@localhost etc]$ sudo docker ps
CONTAINER ID   IMAGE       COMMAND                  CREATED          STATUS          PORTS
               NAMES
ab0cd95f6c9f   mysql:5.7   "docker-entrypoint.s…"   19 seconds ago   Up 18 seconds   0.0.0.0:3306->3306/tcp, :::3306->3306/t
cp, 33060/tcp   mysql
[vagrant@localhost etc]$

# 进入到mysql镜像(独立的Linux环境)的命令
[vagrant@localhost etc]$ sudo docker exec -it mysql /bin/bash
bash-4.2# ls
bin   dev                         entrypoint.sh  home  lib64  mnt  proc  run   srv  tmp  var
boot  docker-entrypoint-initdb.d  etc            lib   media  opt  root  sbin  sys  usr
bash-4.2# cd /
bash-4.2# ls
bin   dev                         entrypoint.sh  home  lib64  mnt  proc  run   srv  tmp  var
boot  docker-entrypoint-initdb.d  etc            lib   media  opt  root  sbin  sys  usr
bash-4.2# mysql -u root -p
Enter password:
Welcome to the MySQL monitor.  Commands end with ; or \g.
Your MySQL connection id is 2
Server version: 5.7.44 MySQL Community Server (GPL)

Copyright (c) 2000, 2023, Oracle and/or its affiliates.

Oracle is a registered trademark of Oracle Corporation and/or its
affiliates. Other names may be trademarks of their respective
owners.

Type 'help;' or '\h' for help. Type '\c' to clear the current input statement.

mysql> show databases;
+--------------------+
| Database           |
+--------------------+
| information_schema |
| mysql              |
| performance_schema |
| sys                |
+--------------------+
4 rows in set (0.00 sec)

mysql> exit;
Bye
#当前登录的用户是root
bash-4.2# whoami
root
bash-4.2#
#退出docker容器 mysql镜像的内部Linux系统 `exit`
bash-4.2# exit
exit
[vagrant@localhost etc]$
~~~

启动成功如下

![image-20240212072854344](https://raw.githubusercontent.com/EXsYang/PicGo-images-hosting/main/images/image-20240212072854344.png)



![image-20240212075342712](https://raw.githubusercontent.com/EXsYang/PicGo-images-hosting/main/images/image-20240212075342712.png)





# 11 Docker mysql容器常用命令

~~~sh
#下面这个好使，是上面这个调整格式后的代码，区别就是加了一层目录`/conf.d`,目录没有会自动创建
sudo docker run -p 3306:3306 --name mysql \
-v /mydata/mysql/log:/var/log/mysql \
-v /mydata/mysql/data:/var/lib/mysql \
-v /mydata/mysql/conf:/etc/mysql/conf.d \
-e MYSQL_ROOT_PASSWORD=root \
-d mysql:5.7

#同一个mysql5.7镜像可以支持运行多个mysql容器
sudo docker run -p 3307:3306 --name mysql2 \
-v /mydata2/mysql/log:/var/log/mysql \
-v /mydata2/mysql/data:/var/lib/mysql \
-v /mydata2/mysql/conf:/etc/mysql/conf.d \
-e MYSQL_ROOT_PASSWORD=root \
-d mysql:5.7

#查看mysql容器是否启动成功，即看STATUS是否显示为UP
sudo docker ps
#启动mysql容器 下面这里的mysql 注意代表的是容器的名称！！
sudo docker start mysql

#重启mysql容器
sudo docker restart mysql

#停止mysql容器
sudo docker stop mysql

# 进入到mysql镜像(独立的Linux环境)的命令，这里的`mysql`,是容器名称
sudo docker exec -it mysql /bin/bash

# 从Docker守护进程中删除一个名为 `mysql` 的容器。
sudo docker rm mysql 


~~~

# 12 vagrant ssh登录Linux后切换为root用户，密码默认是vagrant,执行命令时就不用加 sudo 了

![image-20240212083522970](https://raw.githubusercontent.com/EXsYang/PicGo-images-hosting/main/images/image-20240212083522970.png)

# 13 同一个mysql5.7镜像可以支持运行多个mysql容器 

~~~
[vagrant@localhost ~]$ sudo docker run -p 3307:3306 --name mysql2 \
> -v /mydata2/mysql/log:/var/log/mysql \
> -v /mydata2/mysql/data:/var/lib/mysql \
> -v /mydata2/mysql/conf:/etc/mysql/conf.d \
> -e MYSQL_ROOT_PASSWORD=root \
> -d mysql:5.7
640aefa27b71113d2b82bdfbb54d9c8dafb5bc8b946ff009c19be352e189e65e
[vagrant@localhost ~]$ sudo docker ps
CONTAINER ID   IMAGE       COMMAND                  CREATED          STATUS          PORTS                                                  NAMES
640aefa27b71   mysql:5.7   "docker-entrypoint.s…"   12 seconds ago   Up 10 seconds   33060/tcp, 0.0.0.0:3307->3306/tcp, :::3307->3306/tcp   mysql2
ab0cd95f6c9f   mysql:5.7   "docker-entrypoint.s…"   58 minutes ago   Up 17 minutes   0.0.0.0:3306->3306/tcp, :::3306->3306/tcp, 33060/tcp   mysql
[vagrant@localhost ~]$ sudo docker stop mysql2
mysql2
[vagrant@localhost ~]$ sudo docker ps
CONTAINER ID   IMAGE       COMMAND                  CREATED          STATUS          PORTS                                                  NAMES
ab0cd95f6c9f   mysql:5.7   "docker-entrypoint.s…"   59 minutes ago   Up 18 minutes   0.0.0.0:3306->3306/tcp, :::3306->3306/tcp, 33060/tcp   mysql
[vagrant@localhost ~]$
~~~

![image-20240212081950601](https://raw.githubusercontent.com/EXsYang/PicGo-images-hosting/main/images/image-20240212081950601.png)



# 14 Docker 删除名为 `mysql` 的容器，命令 `sudo docker rm mysql` 

命令 `sudo docker rm mysql` 用于从Docker守护进程中删除一个名为 `mysql` 的容器。这里的各个部分含义如下：

- `sudo`: 由于Docker守护进程通常需要超级用户权限来执行操作，`sudo` 命令确保了当前命令以超级用户（或root用户）的权限运行。这可以确保命令有足够的权限对Docker守护进程进行容器的删除操作。
- `docker`: 这是执行Docker命令行工具的调用命令，用于与Docker守护进程进行交互。
- `rm`: 这是Docker命令行工具的一个子命令，用于删除一个或多个容器。使用 `rm` 命令时，你需要指定要删除的容器的名称或ID。
- `mysql`: 这是要删除的Docker容器的名称。在这个例子中，容器名称为 `mysql`。你也可以使用容器的ID代替名称来指定要删除的容器。

执行 `sudo docker rm mysql` 命令时，Docker会尝试删除名为 `mysql` 的容器。如果容器正在运行，这个命令会失败，因为默认情况下，Docker不允许删除正在运行的容器。如果你想强制删除一个正在运行的容器，可以使用 `-f` 或 `--force` 选项，如 `sudo docker rm -f mysql`。

请注意，在删除容器之前，确保你已经备份了容器内任何重要的数据或配置，因为一旦容器被删除，所有与容器相关的数据和配置都将丢失。



# 15 后端环境搭建



~~~
<?xml version="1.0" encoding="UTF-8"?>
<project xmlns="http://maven.apache.org/POM/4.0.0"
         xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
         xsi:schemaLocation="http://maven.apache.org/POM/4.0.0 http://maven.apache.org/xsd/maven-4.0.0.xsd">
    <modelVersion>4.0.0</modelVersion>

    <groupId>com.hspedu.hspliving</groupId>
    <artifactId>hspliving-commodity</artifactId>
    <version>1.0-SNAPSHOT</version>

    <!--导入springboot 父工程-规定写法-->
    <parent>
        <groupId>org.springframework.boot</groupId>
        <artifactId>spring-boot-starter-parent</artifactId>
        <version>2.1.8.RELEASE</version>
        <!--<relativePath/> &lt;!&ndash; lookup parent from repository &ndash;&gt;-->
    </parent>

    <name>hspliving-commodity</name>
    <description>顺平(家居生活)-商品模块</description>
    <properties>
        <java.version>1.8</java.version>
        <spring-cloud.version>2020.0.5</spring-cloud.version>
    </properties>

    <!--引入相关的依赖-->
    <dependencies>
        <!--导入web项目场景启动器: 会自动导入和web开发相关的所有依赖[库/jar]
                     后面老师还会说spring-boot-starter-web 到底引入哪些相关依赖
                     web项目场景启动器,这里是真正的引入了依赖
                     starter-web 版本不需要指定 在父工程已经指定好了
                     -->
        <dependency>
            <groupId>org.springframework.boot</groupId>
            <artifactId>spring-boot-starter-web</artifactId>
        </dependency>

        <!--引入test starter -->
        <dependency>
            <groupId>org.springframework.boot</groupId>
            <artifactId>spring-boot-starter-test</artifactId>
            <!--只在test模块生效-->
            <scope>test</scope>
        </dependency>

    </dependencies>


    <build>
        <plugins>
            <plugin>
                <groupId>org.springframework.boot</groupId>
                <artifactId>spring-boot-maven-plugin</artifactId>
            </plugin>
        </plugins>
    </build>


</project>
~~~



# 16 解释Maven relativePath元素标签

![image-20240212211938492](https://raw.githubusercontent.com/EXsYang/PicGo-images-hosting/main/images/image-20240212211938492.png)

![image-20240212211150831](https://raw.githubusercontent.com/EXsYang/PicGo-images-hosting/main/images/image-20240212211150831.png)

在Maven项目中，`relativePath`元素通常用于`<parent>`标签内，指定父POM（Project Object Model）文件的位置。Maven是一个项目管理和构建自动化工具，它使用POM文件（`pom.xml`）来管理项目的构建、依赖、插件等。

当一个Maven项目是另一个项目的子项目时，子项目的POM文件中会包含对父项目的引用。这个引用通过`<parent>`标签来实现，其中包含父项目的`groupId`、`artifactId`、`version`，以及可选的`relativePath`元素。`relativePath`元素用于指定父POM文件相对于子项目POM文件的路径。

### 作用

- **默认行为**：如果不指定`relativePath`，Maven默认会查找子项目目录的`../pom.xml`作为父POM。这是因为默认的`relativePath`值是`../pom.xml`，假设父项目和子项目在文件系统中是相邻的目录结构。

- **自定义位置**：通过显式设置`relativePath`，你可以指定一个不同的位置来查找父POM。这在父项目不位于默认位置时非常有用。

- **避免查找**：如果设置`<relativePath/>`（即空的`relativePath`元素），Maven将不会在文件系统中查找父POM。这在父POM仅通过Maven仓库可用时很有帮助，而不是通过文件系统的相对路径。

### 示例

```xml
<parent>
    <groupId>com.example</groupId>
    <artifactId>parent-project</artifactId>
    <version>1.0.0</version>
    <relativePath>../parent-project/pom.xml</relativePath> <!-- 自定义父POM位置 -->
</parent>
```

在这个例子中，`relativePath`指向一个自定义的路径，其中父项目的`pom.xml`文件位于子项目的`../parent-project/`目录下。如果父项目的POM文件不在标准位置，或者你希望从一个特定位置引用父POM，这种方式非常有用。

总之，`relativePath`在Maven项目中是一个灵活的元素，它允许开发者指定父项目POM文件的位置，无论是在本地文件系统中还是在远程仓库中。这有助于维护项目间的层次结构和依赖关系。



# 17 中央仓库明明有对应的jar包，但是刷新maven,导入失败 “Plugin 'com.spotify:docker-maven-plugin:0.4.14' not found”



 ![image-20240212220141206](https://raw.githubusercontent.com/EXsYang/PicGo-images-hosting/main/images/image-20240212220141206.png)



![image-20240212220334462](https://raw.githubusercontent.com/EXsYang/PicGo-images-hosting/main/images/image-20240212220334462.png)



![image-20240212215613461](https://raw.githubusercontent.com/EXsYang/PicGo-images-hosting/main/images/image-20240212215613461.png)



![image-20240212220038363](https://raw.githubusercontent.com/EXsYang/PicGo-images-hosting/main/images/image-20240212220038363.png)



## 多刷新几次！！！



# 18 @MapperScan 和 @Mapper 什么时候可以不写的说明



~~~java
// 如果Dao类上没有写@Mapper注解，则这里需要加上@MapperScan注解，指定要扫描的dao包
// ,如果dao包中的Mapper类上写了@Mapper注解，则这里可以不写
// @MapperScan("com.hspedu.hspliving.commodity.dao")
@SpringBootApplication
public class HsplivingCommodityApplication {
    public static void main(String[] args) {
        //
        SpringApplication.run(HsplivingCommodityApplication.class,args);
    }
}	
~~~



# 19  java: -source 1.5 中不支持 diamond 运算符
  (即钻石符合'<>'报错)(请使用 -source 7 或更高版本以启用 diamond 运算符)

~~~xml
<properties>
        <java.version>1.8</java.version>
        <maven.compiler.source>8</maven.compiler.source>
        <maven.compiler.target>8</maven.compiler.target>
</properties>
~~~



# 20 使用idea打开包含.git文件夹的项目，在idea视图界面看不到.git文件夹



![image-20240225114420778](https://raw.githubusercontent.com/EXsYang/PicGo-images-hosting/main/images/image-20240225114420778.png)

![image-20240225114236333](https://raw.githubusercontent.com/EXsYang/PicGo-images-hosting/main/images/image-20240225114236333.png)

**在 IntelliJ IDEA 中，默认情况下 `.git` 文件夹是被隐藏的，这是因为 `.git` 文件夹包含了 Git 版本控制的所有元数据，而这些信息通常不需要在项目的日常开发过程中直接查看。**IDEA 提供了其他方式来查看和管理 Git 版本控制信息，例如通过 VCS 操作或 Git 面板。

如果你希望在 IntelliJ IDEA 中查看 `.git` 文件夹，可以通过修改设置来实现：

1. 打开 IntelliJ IDEA 并且打开你的项目。

2. 从菜单栏选择 “File” -> “Settings” （对于 macOS，是 “IntelliJ IDEA” -> “Preferences”）。

3. 在设置窗口中，展开 “Editor” 部分，然后选择 “File Types”。

4. 在 “Ignored Files and Folders” 部分，你会看到默认情况下 `.git` 被列在忽略的文件和文件夹列表中。

5. 从这个列表中删除 `.git` 条目。这将使得 `.git` 文件夹在项目视图中可见。

6. 点击 “Apply” 然后 “OK” 来保存你的更改。

请注意，即使这样做可以使 `.git` 文件夹在项目浏览器中可见，但一般不推荐这样做，因为这可能会导致意外修改到版本控制系统的内部文件。如果你需要进行版本控制操作，建议使用 IntelliJ IDEA 提供的 Git 工具和菜单选项来执行这些操作，而不是直接修改 `.git` 文件夹中的文件。

# 21 







