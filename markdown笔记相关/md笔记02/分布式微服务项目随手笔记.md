# 1 登录到Linux的指令

~~~
#启动Linux虚拟机
vagrant up
#关闭Linux虚拟机
vagrant halt


#使用ssh连接到Linux虚拟机	默认用户名是vagrant
vagrant ssh

#退出ssh连接
exit

D:\Java_developer_tools\DistributedMicroservicesProject\vbcentos7>vagrant init centos/7
==> vagrant: A new version of Vagrant is available: 2.4.1 (installed version: 2.2.18)!
==> vagrant: To upgrade visit: https://www.vagrantup.com/downloads.html

A `Vagrantfile` has been placed in this directory. You are now
ready to `vagrant up` your first virtual environment! Please read
the comments in the Vagrantfile as well as documentation on
`vagrantup.com` for more information on using Vagrant.

D:\Java_developer_tools\DistributedMicroservicesProject\vbcentos7>vagrant up
Bringing machine 'default' up with 'virtualbox' provider...
==> default: Box 'centos/7' could not be found. Attempting to find and install...
    default: Box Provider: virtualbox
    default: Box Version: >= 0
==> default: Loading metadata for box 'centos/7'
    default: URL: https://vagrantcloud.com/centos/7
==> default: Adding box 'centos/7' (v2004.01) for provider: virtualbox
    default: Downloading: https://vagrantcloud.com/centos/boxes/7/versions/2004.01/providers/virtualbox/unknown/vagrant.
box
Download redirected to host: cloud.centos.org
    default:
    default: Calculating and comparing box checksum...
==> default: Successfully added box 'centos/7' (v2004.01) for 'virtualbox'!
==> default: Importing base box 'centos/7'...
==> default: Matching MAC address for NAT networking...
==> default: Checking if box 'centos/7' version '2004.01' is up to date...
==> default: Setting the name of the VM: vbcentos7_default_1707581882874_11921
==> default: Clearing any previously set network interfaces...
==> default: Preparing network interfaces based on configuration...
    default: Adapter 1: nat
==> default: Forwarding ports...
    default: 22 (guest) => 2222 (host) (adapter 1)
==> default: Booting VM...
==> default: Waiting for machine to boot. This may take a few minutes...
    default: SSH address: 127.0.0.1:2222
    default: SSH username: vagrant
    default: SSH auth method: private key
    default:
    default: Vagrant insecure key detected. Vagrant will automatically replace
    default: this with a newly generated keypair for better security.
    default:
    default: Inserting generated public key within guest...
    default: Removing insecure key from the guest if it's present...
    default: Key inserted! Disconnecting and reconnecting using new SSH key...
==> default: Machine booted and ready!
==> default: Checking for guest additions in VM...
    default: No guest additions were detected on the base box for this VM! Guest
    default: additions are required for forwarded ports, shared folders, host only
    default: networking, and more. If SSH fails on this machine, please install
    default: the guest additions and repackage the box to continue.
    default:
    default: This is not an error message; everything may continue to work properly,
    default: in which case you may ignore this message.
==> default: Rsyncing folder: /cygdrive/d/Java_developer_tools/DistributedMicroservicesProject/vbcentos7/ => /vagrant

D:\Java_developer_tools\DistributedMicroservicesProject\vbcentos7>vagrant ssh
[vagrant@localhost ~]$ pwd
/home/vagrant
[vagrant@localhost ~]$ ls
[vagrant@localhost ~]$ cd /
[vagrant@localhost /]$ ls
bin   dev  home  lib64  mnt  proc  run   srv       sys  usr      var
boot  etc  lib   media  opt  root  sbin  swapfile  tmp  vagrant
[vagrant@localhost /]$ cat /etc/centos-release
CentOS Linux release 7.8.2003 (Core)
[vagrant@localhost /]$ exit
logout
Connection to 127.0.0.1 closed.

D:\Java_developer_tools\DistributedMicroservicesProject\vbcentos7>

~~~



要关闭使用 Vagrant 启动的 CentOS 7 虚拟机，您可以使用 `vagrant halt` 命令。这个命令会优雅地关闭虚拟机，确保所有的进程都正确地停止，并且虚拟机状态被安全地保存。

在您的项目目录（在这个例子中是 `D:\Java_developer_tools\DistributedMicroservicesProject\vbcentos7`）下打开命令行界面，然后运行以下命令：

```
vagrant halt
```

如果您想要暂时挂起虚拟机（保存其当前状态以便可以快速恢复），可以使用 `vagrant suspend`。要重新启动被挂起或停止的虚拟机，可以使用 `vagrant up`。 若要彻底删除虚拟机（包括其所有的文件和状态），可以使用 `vagrant destroy`。请注意，`vagrant destroy` 命令会移除虚拟机，如果你再次需要它，将必须重新创建和配置。



# 2 禁用Hyper-V

禁用Hyper-V可以通过几种不同的方法完成，具体取决于您使用的Windows版本。下面是一些常用的方法：

### 通过Windows功能禁用

1. 在搜索栏输入“Windows功能”，然后选择“打开或关闭Windows功能”。
2. 在弹出的窗口中，找到“Hyper-V”，取消选中旁边的复选框。
3. 点击“确定”按钮，然后根据提示重启计算机。

### 通过命令提示符禁用

1. 以管理员身份打开命令提示符。可以在搜索栏输入“cmd”，然后右键“命令提示符”，选择“以管理员身份运行”。
2. 在命令提示符窗口中，输入以下命令来禁用Hyper-V：
   ```
   dism.exe /Online /Disable-Feature:Microsoft-Hyper-V
   ```
3. 按照提示重启计算机以完成更改。

### 通过PowerShell禁用

1. 以管理员身份打开PowerShell。可以在搜索栏输入“PowerShell”，然后右键“Windows PowerShell”，选择“以管理员身份运行”。
2. 在PowerShell窗口中，输入以下命令来禁用Hyper-V：
   ```
   Disable-WindowsOptionalFeature -Online -FeatureName Microsoft-Hyper-V-All
   ```
3. 按照提示重启计算机以完成更改。

### 注意事项

- 禁用Hyper-V后，任何依赖于Hyper-V的功能或服务（如Windows沙盒、Windows子系统 for Linux 2 (WSL2)）可能无法正常工作。
- 如果您的计算机上安装了其他虚拟化软件（如VirtualBox或VMware），禁用Hyper-V可能有助于解决兼容性问题。
- 在某些情况下，特别是在Windows 10或Windows 11上，您可能还需要禁用与虚拟化相关的其他功能，如虚拟机平台和Windows Hypervisor Platform。

在完成这些步骤之后，Hyper-V应该被禁用，您可以尝试重新使用VirtualBox或其他虚拟化软件。如果您决定在将来重新启用Hyper-V，只需按照上述步骤操作，但选择启用Hyper-V功能即可。

# 3 禁用Hyper-V会影响其他虚拟软件的启动吗？比如VMware

禁用Hyper-V对其他虚拟化软件（如VMware Workstation或Oracle VM VirtualBox）的影响取决于具体的虚拟化技术和软件版本。以下是一些可能的影响和考虑因素：

### VMware Workstation

- **正面影响**：禁用Hyper-V通常对VMware Workstation是有益的，尤其是在早期版本中。因为Hyper-V是一种类型1虚拟化技术，而VMware Workstation是类型2，两者同时运行可能会引起冲突。禁用Hyper-V可以提高VMware的性能和兼容性。
- **启用VT-x/EPT或AMD-V/RVI**：禁用Hyper-V后，确保在BIOS/UEFI设置中启用了VT-x（对于Intel处理器）或AMD-V（对于AMD处理器）及其扩展（如EPT或RVI），这对于VMware正常工作是必要的。

### Oracle VM VirtualBox

- **正面影响**：对于VirtualBox，禁用Hyper-V也往往有好处。尽管VirtualBox从5.0版本开始提供了对Hyper-V作为后备执行引擎的支持，但这可能会降低性能。完全禁用Hyper-V可以让VirtualBox直接利用硬件虚拟化，从而提高性能。
- **版本兼容性**：确保您使用的VirtualBox版本最优化地支持您的操作系统，尤其是在没有Hyper-V的情况下。

### 其他虚拟化软件

- 对于其他虚拟化软件，如QEMU、KVM（在Linux上）等，禁用Hyper-V不会直接影响它们的运行。这些软件通常使用不同的虚拟化技术，与Hyper-V的兼容性问题较少。

### 注意事项

- **操作系统功能**：禁用Hyper-V可能会影响依赖于Hyper-V的Windows功能，如Windows沙箱和Windows子系统 for Linux（WSL 2）。这些功能需要Hyper-V来运行。
- **性能考虑**：在某些情况下，如果您的工作或开发环境不依赖于Hyper-V特定的功能，禁用Hyper-V可能会带来性能上的提升。
- **软件版本**：在禁用Hyper-V之前，请检查您所使用的虚拟化软件的文档，以确认其对Hyper-V的支持情况以及不使用Hyper-V时的推荐配置。

总的来说，禁用Hyper-V通常对使用VMware Workstation或VirtualBox等其他虚拟化软件有积极影响，特别是在解决兼容性问题和提高性能方面。然而，做出改变之前，请考虑任何依赖于Hyper-V的功能或服务。



# 4 宿主机和Linux网络互通

windows宿主机在VirtualBox虚拟网络里的IP地址如下:192.168.56.1 

使用命令行命令`ipconfig /all`

![image-20240211223037813](https://raw.githubusercontent.com/EXsYang/PicGo-images-hosting/main/images/image-20240211223037813.png)



![image-20240211223223891](https://raw.githubusercontent.com/EXsYang/PicGo-images-hosting/main/images/image-20240211223223891.png)

~~~
#windows真实的上网ip
192.168.0.13

#windows宿主机在VirtualBox虚拟网络里的IP 
192.168.0.13

#vagrant配置的CentOS7.8 Linux 的ip
192.168.56.100

#重新加载vagrant配置文件
vagrant reload

#登录到Linux
vagrant ssh

#查看当前ip(注意ifconfig此时用不了，需要安装netTools)
ip addr


~~~



查看修改后的Linux虚拟机IP：

![image-20240211223707217](https://raw.githubusercontent.com/EXsYang/PicGo-images-hosting/main/images/image-20240211223707217.png)



宿主机ping Linux虚拟机test1:

~~~
C:\Users\yangd>ping 192.168.56.100

正在 Ping 192.168.56.100 具有 32 字节的数据:
来自 192.168.56.100 的回复: 字节=32 时间<1ms TTL=255
来自 192.168.56.100 的回复: 字节=32 时间<1ms TTL=64
来自 192.168.56.100 的回复: 字节=32 时间<1ms TTL=64
来自 192.168.56.100 的回复: 字节=32 时间<1ms TTL=64

192.168.56.100 的 Ping 统计信息:
    数据包: 已发送 = 4，已接收 = 4，丢失 = 0 (0% 丢失)，
往返行程的估计时间(以毫秒为单位):
    最短 = 0ms，最长 = 0ms，平均 = 0ms

C:\Users\yangd>
~~~



Linux虚拟机ping windows宿主机在VirtualBox虚拟网络里的IP：192.168.56.1 test2:  

![image-20240211223037813](https://raw.githubusercontent.com/EXsYang/PicGo-images-hosting/main/images/image-20240211223037813.png)

~~~
 [vagrant@localhost ~]$ ping 192.168.56.1
PING 192.168.56.1 (192.168.56.1) 56(84) bytes of data.
64 bytes from 192.168.56.1: icmp_seq=1 ttl=128 time=0.232 ms
64 bytes from 192.168.56.1: icmp_seq=2 ttl=128 time=0.208 ms
64 bytes from 192.168.56.1: icmp_seq=3 ttl=128 time=0.221 ms
64 bytes from 192.168.56.1: icmp_seq=4 ttl=128 time=0.207 ms
^C
--- 192.168.56.1 ping statistics ---
4 packets transmitted, 4 received, 0% packet loss, time 3016ms
rtt min/avg/max/mdev = 0.207/0.217/0.232/0.010 ms
[vagrant@localhost ~]$

~~~





Linux虚拟机ping 宿主机 实际上网地址 test3: **测试虚拟机能否访问外部网络**

![image-20240211224611095](https://raw.githubusercontent.com/EXsYang/PicGo-images-hosting/main/images/image-20240211224611095.png)

~~~
 [vagrant@localhost ~]$ ping 192.168.0.13
PING 192.168.0.13 (192.168.0.13) 56(84) bytes of data.
64 bytes from 192.168.0.13: icmp_seq=1 ttl=127 time=0.444 ms
64 bytes from 192.168.0.13: icmp_seq=2 ttl=127 time=0.426 ms
64 bytes from 192.168.0.13: icmp_seq=3 ttl=127 time=0.474 ms
64 bytes from 192.168.0.13: icmp_seq=4 ttl=127 time=0.423 ms
^C
--- 192.168.0.13 ping statistics ---
4 packets transmitted, 4 received, 0% packet loss, time 3026ms
rtt min/avg/max/mdev = 0.423/0.441/0.474/0.032 ms
[vagrant@localhost ~]$
--------------------------------------------------------
[vagrant@localhost ~]$ ping www.baidu.com
PING www.baidu.com (198.18.0.78) 56(84) bytes of data.
64 bytes from 198.18.0.78 (198.18.0.78): icmp_seq=1 ttl=63 time=0.451 ms
64 bytes from 198.18.0.78 (198.18.0.78): icmp_seq=2 ttl=63 time=0.489 ms
64 bytes from 198.18.0.78 (198.18.0.78): icmp_seq=3 ttl=63 time=0.495 ms
64 bytes from 198.18.0.78 (198.18.0.78): icmp_seq=4 ttl=63 time=0.482 ms
^C
--- www.baidu.com ping statistics ---
4 packets transmitted, 4 received, 0% packet loss, time 3003ms
rtt min/avg/max/mdev = 0.451/0.479/0.495/0.022 ms
[vagrant@localhost ~]$



~~~



# 5 如何使用yum安装netTools,使得Linux可以使用ifconfig命令呢？

要在基于Red Hat的Linux发行版（如RHEL, CentOS, Fedora等）上安装`net-tools`包（这个包包含了`ifconfig`命令），你可以使用`yum`（在较旧的版本中）或`dnf`（在较新的版本中，如Fedora和RHEL 8及以上版本）包管理器。以下是使用`yum`安装`net-tools`的步骤：

1. 打开终端。

2. 输入以下命令来安装`net-tools`：

   ```
   sudo yum install net-tools
   ```

   - 这条命令会提示你输入管理员密码，输入后按回车继续。
   - 系统可能会询问你是否确认下载和安装，输入`y`然后按回车确认。

安装完成后，你就可以使用`ifconfig`命令来查看网络接口的配置了。只需在终端中输入：

```
ifconfig
```

如果你的系统使用的是`dnf`包管理器（如在Fedora或RHEL 8及以上版本），安装命令略有不同：

```
sudo dnf install net-tools
```

以上步骤适用于大多数基于Red Hat的Linux发行版。如果你使用的是基于Debian的发行版（如Ubuntu），则需要使用`apt`包管理器来安装`net-tools`：

```
sudo apt-get update
sudo apt-get install net-tools
```

这些命令将确保你的系统能够使用`ifconfig`命令来管理和查看网络接口。







